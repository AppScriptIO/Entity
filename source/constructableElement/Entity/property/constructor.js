"use strict";var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");var _EntityClass = require("../Entity.class.js");
var Constructable = _interopRequireWildcard(require("../../Constructable/Constructable.class.js"));
var _instantiate = require("../../Constructable/property/instantiate.js");
var _handlePrototypeDelegation = require("@dependency/handlePrototypeDelegation");

function createStateInstanceWithMultipleDelegation({ delegationList = [] } = {}) {
  const callerClass = this;
  let stateDelegationSetting = callerClass[Constructable.$.prototypeDelegation.getter].call(callerClass, _EntityClass.$.key.stateInstance);

  let instance = (0, _instantiate.createObjectWithDelegation)({ instanceType: 'object' });
  Object.setPrototypeOf(instance, stateDelegationSetting.instancePrototype);


  if (delegationList.length > 0) _handlePrototypeDelegation.MultipleDelegation.addDelegation({ targetObject: instance, delegationList });
  return instance;
}





module.exports = {



  [_EntityClass.$.key.stateInstance]({ callerClass = this } = {}, { delegationList } = {}) {
    let instance = createStateInstanceWithMultipleDelegation.call(callerClass, { delegationList });
    return instance;
  },


  [_EntityClass.$.key.handleDataInstance]({ callerClass = this } = {}, ...args) {
    let instance = createStateInstanceWithMultipleDelegation.call(callerClass);

    callerClass[Constructable.$.initialize.switch].call(callerClass, _EntityClass.$.key.handleDataInstance, { recursiveDelegationChainExecution: true })({ targetInstance: instance }, ...args);
    return instance;
  },





  [_EntityClass.$.key.concereteBehavior]({ callerClass = this } = {}, { delegationList, concreteBehaviorList = [] }) {

    let instance = createStateInstanceWithMultipleDelegation.call(callerClass, { delegationList });


    callerClass[Constructable.$.initialize.switch].call(callerClass, _EntityClass.$.key.concereteBehavior, { recursiveDelegationChainExecution: true })({ targetInstance: instance }, { concreteBehaviorList });









    for (let concereteBehavior of concreteBehaviorList) {
      if (concereteBehavior[_EntityClass.$.key.concereteBehavior]) concereteBehavior[_EntityClass.$.key.concereteBehavior]({ targetInstance: instance }, { concereteBehavior });
    }

    return instance;
  } };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NvdXJjZS9jb25zdHJ1Y3RhYmxlRWxlbWVudC9FbnRpdHkvcHJvcGVydHkvY29uc3RydWN0b3IuanMiXSwibmFtZXMiOlsiY3JlYXRlU3RhdGVJbnN0YW5jZVdpdGhNdWx0aXBsZURlbGVnYXRpb24iLCJkZWxlZ2F0aW9uTGlzdCIsImNhbGxlckNsYXNzIiwic3RhdGVEZWxlZ2F0aW9uU2V0dGluZyIsIkNvbnN0cnVjdGFibGUiLCIkIiwicHJvdG90eXBlRGVsZWdhdGlvbiIsImdldHRlciIsImtleSIsInN0YXRlSW5zdGFuY2UiLCJpbnN0YW5jZSIsImluc3RhbmNlVHlwZSIsIk9iamVjdCIsInNldFByb3RvdHlwZU9mIiwiaW5zdGFuY2VQcm90b3R5cGUiLCJsZW5ndGgiLCJNdWx0aXBsZURlbGVnYXRpb24iLCJhZGREZWxlZ2F0aW9uIiwidGFyZ2V0T2JqZWN0IiwibW9kdWxlIiwiZXhwb3J0cyIsImhhbmRsZURhdGFJbnN0YW5jZSIsImFyZ3MiLCJpbml0aWFsaXplIiwic3dpdGNoIiwicmVjdXJzaXZlRGVsZWdhdGlvbkNoYWluRXhlY3V0aW9uIiwidGFyZ2V0SW5zdGFuY2UiLCJjb25jZXJldGVCZWhhdmlvciIsImNvbmNyZXRlQmVoYXZpb3JMaXN0Il0sIm1hcHBpbmdzIjoib0dBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EseUNBQVQsQ0FBbUQsRUFBRUMsY0FBYyxHQUFHLEVBQW5CLEtBQTBCLEVBQTdFLEVBQWlGO0FBQy9FLFFBQU1DLFdBQVcsR0FBRyxJQUFwQjtBQUNBLE1BQUlDLHNCQUFzQixHQUFnQkQsV0FBVyxDQUFDRSxhQUFhLENBQUNDLENBQWQsQ0FBZ0JDLG1CQUFoQixDQUFvQ0MsTUFBckMsQ0FBeEIsTUFBQUwsV0FBVyxFQUEwREcsZUFBRUcsR0FBRixDQUFNQyxhQUFoRSxDQUF4Qzs7QUFFQSxNQUFJQyxRQUFRLEdBQUcsNkNBQTJCLEVBQUVDLFlBQVksRUFBRSxRQUFoQixFQUEzQixDQUFmO0FBQ0FDLEVBQUFBLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkgsUUFBdEIsRUFBZ0NQLHNCQUFzQixDQUFDVyxpQkFBdkQ7OztBQUdBLE1BQUliLGNBQWMsQ0FBQ2MsTUFBZixHQUF3QixDQUE1QixFQUErQkMsOENBQW1CQyxhQUFuQixDQUFpQyxFQUFFQyxZQUFZLEVBQUVSLFFBQWhCLEVBQTBCVCxjQUExQixFQUFqQztBQUMvQixTQUFPUyxRQUFQO0FBQ0Q7Ozs7OztBQU1EUyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7Ozs7QUFJZixHQUFDZixlQUFFRyxHQUFGLENBQU1DLGFBQVAsRUFBc0IsRUFBRVAsV0FBVyxHQUFHLElBQWhCLEtBQXlCLEVBQS9DLEVBQW1ELEVBQUVELGNBQUYsS0FBcUIsRUFBeEUsRUFBNEU7QUFDMUUsUUFBSVMsUUFBUSxHQUFnQlYseUNBQWIsTUFBQUUsV0FBVyxFQUE0QyxFQUFFRCxjQUFGLEVBQTVDLENBQTFCO0FBQ0EsV0FBT1MsUUFBUDtBQUNELEdBUGM7OztBQVVmLEdBQUNMLGVBQUVHLEdBQUYsQ0FBTWEsa0JBQVAsRUFBMkIsRUFBRW5CLFdBQVcsR0FBRyxJQUFoQixLQUF5QixFQUFwRCxFQUF3RCxHQUFHb0IsSUFBM0QsRUFBaUU7QUFDL0QsUUFBSVosUUFBUSxHQUFnQlYseUNBQWIsTUFBQUUsV0FBVyxDQUExQjs7QUFFYUEsSUFBQUEsV0FBVyxDQUFDRSxhQUFhLENBQUNDLENBQWQsQ0FBZ0JrQixVQUFoQixDQUEyQkMsTUFBNUIsQ0FBeEIsTUFBQXRCLFdBQVcsRUFBaURHLGVBQUVHLEdBQUYsQ0FBTWEsa0JBQXZELEVBQTJFLEVBQUVJLGlDQUFpQyxFQUFFLElBQXJDLEVBQTNFLENBQVgsQ0FBbUksRUFBRUMsY0FBYyxFQUFFaEIsUUFBbEIsRUFBbkksRUFBaUssR0FBR1ksSUFBcEs7QUFDQSxXQUFPWixRQUFQO0FBQ0QsR0FmYzs7Ozs7O0FBcUJmLEdBQUNMLGVBQUVHLEdBQUYsQ0FBTW1CLGlCQUFQLEVBQTBCLEVBQUV6QixXQUFXLEdBQUcsSUFBaEIsS0FBeUIsRUFBbkQsRUFBdUQsRUFBRUQsY0FBRixFQUFrQjJCLG9CQUFvQixHQUFHLEVBQXpDLEVBQXZELEVBQXNHOztBQUVwRyxRQUFJbEIsUUFBUSxHQUFnQlYseUNBQWIsTUFBQUUsV0FBVyxFQUE0QyxFQUFFRCxjQUFGLEVBQTVDLENBQTFCOzs7QUFHYUMsSUFBQUEsV0FBVyxDQUFDRSxhQUFhLENBQUNDLENBQWQsQ0FBZ0JrQixVQUFoQixDQUEyQkMsTUFBNUIsQ0FBeEIsTUFBQXRCLFdBQVcsRUFBaURHLGVBQUVHLEdBQUYsQ0FBTW1CLGlCQUF2RCxFQUEwRSxFQUFFRixpQ0FBaUMsRUFBRSxJQUFyQyxFQUExRSxDQUFYLENBQWtJLEVBQUVDLGNBQWMsRUFBRWhCLFFBQWxCLEVBQWxJLEVBQWdLLEVBQUVrQixvQkFBRixFQUFoSzs7Ozs7Ozs7OztBQVVBLFNBQUssSUFBSUQsaUJBQVQsSUFBOEJDLG9CQUE5QixFQUFvRDtBQUNsRCxVQUFJRCxpQkFBaUIsQ0FBQ3RCLGVBQUVHLEdBQUYsQ0FBTW1CLGlCQUFQLENBQXJCLEVBQWdEQSxpQkFBaUIsQ0FBQ3RCLGVBQUVHLEdBQUYsQ0FBTW1CLGlCQUFQLENBQWpCLENBQTJDLEVBQUVELGNBQWMsRUFBRWhCLFFBQWxCLEVBQTNDLEVBQXlFLEVBQUVpQixpQkFBRixFQUF6RTtBQUNqRDs7QUFFRCxXQUFPakIsUUFBUDtBQUNELEdBekNjLEVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgJCB9IGZyb20gJy4uL0VudGl0eS5jbGFzcy5qcydcbmltcG9ydCAqIGFzIENvbnN0cnVjdGFibGUgZnJvbSAnLi4vLi4vQ29uc3RydWN0YWJsZS9Db25zdHJ1Y3RhYmxlLmNsYXNzLmpzJ1xuaW1wb3J0IHsgY3JlYXRlT2JqZWN0V2l0aERlbGVnYXRpb24gfSBmcm9tICcuLi8uLi9Db25zdHJ1Y3RhYmxlL3Byb3BlcnR5L2luc3RhbnRpYXRlLmpzJ1xuaW1wb3J0IHsgTXVsdGlwbGVEZWxlZ2F0aW9uIH0gZnJvbSAnQGRlcGVuZGVuY3kvaGFuZGxlUHJvdG90eXBlRGVsZWdhdGlvbidcblxuZnVuY3Rpb24gY3JlYXRlU3RhdGVJbnN0YW5jZVdpdGhNdWx0aXBsZURlbGVnYXRpb24oeyBkZWxlZ2F0aW9uTGlzdCA9IFtdIH0gPSB7fSkge1xuICBjb25zdCBjYWxsZXJDbGFzcyA9IHRoaXNcbiAgbGV0IHN0YXRlRGVsZWdhdGlvblNldHRpbmcgPSBjYWxsZXJDbGFzczo6Y2FsbGVyQ2xhc3NbQ29uc3RydWN0YWJsZS4kLnByb3RvdHlwZURlbGVnYXRpb24uZ2V0dGVyXSgkLmtleS5zdGF0ZUluc3RhbmNlKVxuXG4gIGxldCBpbnN0YW5jZSA9IGNyZWF0ZU9iamVjdFdpdGhEZWxlZ2F0aW9uKHsgaW5zdGFuY2VUeXBlOiAnb2JqZWN0JyB9KVxuICBPYmplY3Quc2V0UHJvdG90eXBlT2YoaW5zdGFuY2UsIHN0YXRlRGVsZWdhdGlvblNldHRpbmcuaW5zdGFuY2VQcm90b3R5cGUpIC8vIGluaXRpYWxpemUgaW5zdGFuY2Ugd2l0aCBlbnRpdHkgZGVsZWdhdGlvbiB2YWx1ZXMsIGluaGVyaXQgb3duIGFuZCBkZWxlZ2F0ZWQgZnVuY3Rpb25hbGl0aWVzIHJlbGF0ZWQgdG8gc3RhdGUgaW5zdGFuY2UgZnJvbSBFbnRpdHkgY2xhc3MuXG5cbiAgLy8gYWRkIGFkZGl0aW9uYWwgZGVsZWdhdGlvbiBwcm90b3R5cGVzXG4gIGlmIChkZWxlZ2F0aW9uTGlzdC5sZW5ndGggPiAwKSBNdWx0aXBsZURlbGVnYXRpb24uYWRkRGVsZWdhdGlvbih7IHRhcmdldE9iamVjdDogaW5zdGFuY2UsIGRlbGVnYXRpb25MaXN0IH0pXG4gIHJldHVybiBpbnN0YW5jZVxufVxuXG4vLyBFeGFtcGxlOiBUcnlpbmcgdG8gb3ZlcnJpZGUgYSBzeW1ib2wgb2YgYSBwYXJlbnQgY2xhc3MgaW4gdGhlIGNoaWxkIGNsYXNzIHByb3BlcnRpZXMsIHdoZW4gY2FsbGVkIHdpdGggcmVjdXJzaXZlIG9wdGlvbiAoZS5nLiBpbiBDb25zdHJ1Y3RhYmxlLiQuY29uc3RydWN0KSB3aWxsIGV4ZWN1dGUgYWxsIGZ1bmN0aW9ucyB3aXRoIHRoZSBzYW1lIGtleSB0aHJvdWdob3V0IHRoZSBwcm90b3R5cGUgY2hhaW4uXG4vLyBleHBvcnQgW0NvbnN0cnVjdGFibGUuJC5pbml0aWFsaXplLmtleS5jb25zdHJ1Y3RhYmxlSW5zdGFuY2VdKCkge1xuLy8gICBjb25zb2xlLmxvZyhgRXhlY3V0ZWQgdG9nZXRoZXIgd2l0aCBvdGhlciBDb25zdHJ1Y3RhYmxlLiQuaW5pdGlhbGl6ZS5rZXkuY29uc3RydWN0YWJsZUluc3RhbmNlIGluIHRoZSBwcm90b3R5cGUgY2hhaW5gKVxuLy8gfVxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIC8vIFskLmtleS5jb25zdHJ1Y3RhYmxlSW5zdGFuY2VdIC0gd2hlbiBjYWxsZWQgaXQgaXMgaW5oZXJpdGVkIGZyb20gcGFyZW50IGZ1bmN0aW9uYWxpdHkuXG5cbiAgLy8gRXhhbXBsZSBzdGF0ZSBpbnN0YW5jZSBjb25zdHJ1Y3RvciwgdXNlZCBpbiB1bml0IHRlc3RzLlxuICBbJC5rZXkuc3RhdGVJbnN0YW5jZV0oeyBjYWxsZXJDbGFzcyA9IHRoaXMgfSA9IHt9LCB7IGRlbGVnYXRpb25MaXN0IH0gPSB7fSkge1xuICAgIGxldCBpbnN0YW5jZSA9IGNhbGxlckNsYXNzOjpjcmVhdGVTdGF0ZUluc3RhbmNlV2l0aE11bHRpcGxlRGVsZWdhdGlvbih7IGRlbGVnYXRpb25MaXN0IH0pXG4gICAgcmV0dXJuIGluc3RhbmNlXG4gIH0sXG5cbiAgLy8gc3RhdGUgaW5zdGFuY2U6IHN1YmNsYXNzZXMgd2lsbCBwcm92aWRlIGFuIGluaXRpYWxpemF0aW9uIGltcGxlbWVudGF0aW9uIHdpdGgga2V5ICdoYW5kbGVEYXRhSW5zdGFuY2UnXG4gIFskLmtleS5oYW5kbGVEYXRhSW5zdGFuY2VdKHsgY2FsbGVyQ2xhc3MgPSB0aGlzIH0gPSB7fSwgLi4uYXJncykge1xuICAgIGxldCBpbnN0YW5jZSA9IGNhbGxlckNsYXNzOjpjcmVhdGVTdGF0ZUluc3RhbmNlV2l0aE11bHRpcGxlRGVsZWdhdGlvbigpXG4gICAgLy8gYWxsb3dzIHRoZSBzdWJjbGFzc2VzIHRvIGFkZCBhZGRpdGlvbmFsIGluaXRpYWxpemF0aW9uIHN0ZXBzIHRvIGRlYWwgd2l0aCB0aGUgZGF0YSBwYXJhbWV0ZXIgcHJvdmlkZWQuXG4gICAgY2FsbGVyQ2xhc3M6OmNhbGxlckNsYXNzW0NvbnN0cnVjdGFibGUuJC5pbml0aWFsaXplLnN3aXRjaF0oJC5rZXkuaGFuZGxlRGF0YUluc3RhbmNlLCB7IHJlY3Vyc2l2ZURlbGVnYXRpb25DaGFpbkV4ZWN1dGlvbjogdHJ1ZSB9KSh7IHRhcmdldEluc3RhbmNlOiBpbnN0YW5jZSB9LCAuLi5hcmdzKVxuICAgIHJldHVybiBpbnN0YW5jZVxuICB9LFxuXG4gIC8qIHN0YXRlIGluc3RhbmNlOiBpbml0aWFsaXplIHRhcmdldCBpbnN0YW5jZSB1c2luZyBjb25jZXJldGUgYmFodmlvcnMgdGhhdCBleHRlbmQgaXQuIEVhY2ggY29uY3JldGUgYmVoYXZpb3IgdGFwcyBpbnRvIHRoZSBjb25zdHJ1Y3Rpb24gcGhhc2Ugb2YgdGhlIGluc3RhbmNlLCBhZGRzIGl0c2VsZiBhcyBkZWxlZ2F0aW9uIGFuZCBwcm9jZXNzZXMgdGhlIGluc3RhbmNlLlxuICAgIFRoZSBuYW1lIGBjb25jcmV0ZUJlaGF2aW9yYCBjb21lcyBmcm9tIHRoZSBwYXR0ZXJuIHVzZWQgZm9yIG11bHRpcGxlIGJlaGF2aW9ycy9kZWxlZ2F0aW9uIG9uIG9iamVjdHMuXG4gICAgY29uY3JldGVCZWhhdmlvciA9IHN0YXRlIGluc3RhbmNlIHRoYXQgaGFzIGBFbnRpdHkuJC5rZXkuY29uY2VyZXRlQmVoYXZpb3JgIGluIGl0J3MgY2hhaW4sIHRvIGJlIGV4ZWN1dGVkIGR1cmluZyB0aGUgaW5pdGlhbGl6YXRpb24gcGhhc2Ugb2YgYW5vdGhlciBpbnN0YW5jZSB0aGF0IHVzZXMgaXQuXG4gICovXG4gIFskLmtleS5jb25jZXJldGVCZWhhdmlvcl0oeyBjYWxsZXJDbGFzcyA9IHRoaXMgfSA9IHt9LCB7IGRlbGVnYXRpb25MaXN0LCBjb25jcmV0ZUJlaGF2aW9yTGlzdCA9IFtdIH0pIHtcbiAgICAvLyBtZXJnZSBkYXRhIGludG8gaW5zdGFuY2UgcHJvcGVydGllcyB3aXRoIG11bHRpcGxlIGRlbGVnYXRpb24uXG4gICAgbGV0IGluc3RhbmNlID0gY2FsbGVyQ2xhc3M6OmNyZWF0ZVN0YXRlSW5zdGFuY2VXaXRoTXVsdGlwbGVEZWxlZ2F0aW9uKHsgZGVsZWdhdGlvbkxpc3QgfSlcblxuICAgIC8vIHJlbGF0ZWQgdG8gY2xhc3MgaW1wbGVtZW50YXRpb24gKGRpZmZlcmVudCB0aGFuIHRoZSBzdGF0ZSBpbnN0YW5jZSBhdHRhY2hlZCBpbXBsbWVuZXRhdGlvbiBiZWxvdylcbiAgICBjYWxsZXJDbGFzczo6Y2FsbGVyQ2xhc3NbQ29uc3RydWN0YWJsZS4kLmluaXRpYWxpemUuc3dpdGNoXSgkLmtleS5jb25jZXJldGVCZWhhdmlvciwgeyByZWN1cnNpdmVEZWxlZ2F0aW9uQ2hhaW5FeGVjdXRpb246IHRydWUgfSkoeyB0YXJnZXRJbnN0YW5jZTogaW5zdGFuY2UgfSwgeyBjb25jcmV0ZUJlaGF2aW9yTGlzdCB9KSAvLyBhbGxvdyBjbGFzc2VzIHRvIGhvb2sgb3ZlciB0aGUgaW5pdGlhbGl6YWlpb24gcHJvY2Vzcy5cblxuICAgIC8qKiAgaW5pdGlhbGl6ZSBpbnN0YW5jZSB1c2luZyBjb25jcmV0ZSBiZWhhdmlvcnMgaW5zdGFuY2UgdGhlbXNlbHZlcyAtIGkuZS4gcHJvdG90eXBlcyB0byBhZGQgbXVzdCBoYXZlIGEgY29uY2VyZXRlQmVoYXZpb3IgaW1wbGVtZW50YXRpb24gcmVnaXN0ZXJlZCBvbiB0aGVtLlxuICAgICAqIEVhY2ggY29uY2VyZXRlIGJlaGF2aW9yIG11c3QgaW1wbGVtZW50IGFuIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uIHJlZ2lzdGVyZWQgaW4gaXQncyBwcm90eXBlIGNoYWluOiBcbiAgICAgKiBJbiB0aGlzIGV4YW1wbGUgdGhleSB3aWxsIGFkZCB0aGVtc2VsdmVzIHRvIHRoZSBkZWxlZ2F0aW9uIGNoYWluIG9mIHRoZSBpbnN0YW5jZTpcbiAgICAgICAgIFtFbnRpdHkuJC5rZXkuY29uY2VyZXRlQmVoYXZpb3JdKHsgdGFyZ2V0SW5zdGFuY2UsIGNvbmNlcmV0ZUJlaGF2aW9yIH0pIHtcbiAgICAgICAgICAgIE11bHRpcGxlRGVsZWdhdGlvbi5hZGREZWxlZ2F0aW9uKHsgdGFyZ2V0T2JqZWN0OiB0YXJnZXRJbnN0YW5jZSwgZGVsZWdhdGlvbkxpc3Q6IFtjb25jZXJldGVCZWhhdmlvcl0gfSlcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXRJbnN0YW5jZVxuICAgICAgICAgIH1cbiAgICAgICAqL1xuICAgIGZvciAobGV0IGNvbmNlcmV0ZUJlaGF2aW9yIG9mIGNvbmNyZXRlQmVoYXZpb3JMaXN0KSB7XG4gICAgICBpZiAoY29uY2VyZXRlQmVoYXZpb3JbJC5rZXkuY29uY2VyZXRlQmVoYXZpb3JdKSBjb25jZXJldGVCZWhhdmlvclskLmtleS5jb25jZXJldGVCZWhhdmlvcl0oeyB0YXJnZXRJbnN0YW5jZTogaW5zdGFuY2UgfSwgeyBjb25jZXJldGVCZWhhdmlvciB9KVxuICAgIH1cblxuICAgIHJldHVybiBpbnN0YW5jZVxuICB9LFxufVxuIl19